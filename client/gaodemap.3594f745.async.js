(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{Vbh6:function(e,t,a){"use strict";a.r(t);var n=a("9og8"),o=a("k1fw"),c=a("tJVT"),i=a("WmNS"),s=a.n(i),r=a("hi0z"),l=a.n(r),d=a("9kvl"),p=a("q1tI"),u=a("NPPy"),f=a("pf/J"),v="http://api.18gps.net/GetDateServices.asmx";function h(e){return m.apply(this,arguments)}function m(){return m=Object(n["a"])(s.a.mark((function e(t){return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(d["c"])(v+"/loginSystem",Object(o["a"])({method:"GET"},t||{})));case 1:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}function b(e){return w.apply(this,arguments)}function w(){return w=Object(n["a"])(s.a.mark((function e(t){return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(d["c"])(v+"/GetDate",Object(o["a"])({method:"GET"},t||{})));case 1:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}var g=a("Wgwc"),j=a.n(g),A=a("nKUr"),M="vHZI",O=e=>{var t=e.locationEmit,a=e.showCar,i=e.showSelect,r=e.mapHeight,v=Object(p["useState"])(),m=Object(c["a"])(v,2),w=m[0],g=m[1],O=Object(p["useState"])(),x=Object(c["a"])(O,2),k=x[0],y=x[1],I=Object(p["useState"])(),L=Object(c["a"])(I,2),U=L[0],S=L[1],_=Object(p["useState"])(),P=Object(c["a"])(_,2),N=P[0],E=P[1];Object(p["useEffect"])((()=>(!w&&!k&&l.a.load({key:"d7a3a351d9a6a028e07c2688cefa478b",version:"2.0"}).then((e=>{var t=new e.Map("container",{zoom:16,center:["114.316034","30.601385"],viewMode:"3D"});g(e),y(t)})).catch((e=>{console.log(e)})),()=>{k&&(k.destroy(),y(void 0))})),[]);var C=()=>{l.a.load({key:"d7a3a351d9a6a028e07c2688cefa478b",version:"2.0",plugins:["AMap.MapType","AMap.Geolocation","AMap.Geocoder","AMap.PlaceSearch"]}).then((e=>{k.addControl(new e.MapType),S(new e.Geocoder({city:"\u6b66\u6c49\u5e02"})),E(new e.PlaceSearch({city:"\u6b66\u6c49\u5e02"}));var t=new e.Geolocation({enableHighAccuracy:!0,timeout:5e3});f["a"].show("\u5f00\u59cb\u5b9a\u4f4d\uff0c\u8bf7\u6253\u5f00\u4f4d\u7f6e\u4fe1\u606f\u5f00\u5173\uff0c\u5e76\u786e\u8ba4\u7f51\u7edc\u8fde\u63a5\u6b63\u5e38"),t.getCurrentPosition(((e,t)=>{"complete"===e?i&&T({address:"\u6211\u7684\u4f4d\u7f6e",pos:[t.position.lng,t.position.lat]}):(console.log(t),f["a"].show("\u5b9a\u4f4d\u5931\u8d25\uff0c\u8bf7\u6253\u5f00\u4f4d\u7f6e\u4fe1\u606f\u5f00\u5173\uff0c\u5e76\u786e\u8ba4\u7f51\u7edc\u8fde\u63a5\u6b63\u5e38"))}))})).catch((e=>{console.error(e)}))};Object(p["useEffect"])((()=>{k&&k.on("complete",(()=>{k.on("click",(e=>{T(Object(o["a"])(Object(o["a"])({},J),{},{pos:[e.lnglat.getLng(),e.lnglat.getLat()]}))})),C()}))}),[k]);var z=Object(p["useState"])({pos:[],address:""}),G=Object(c["a"])(z,2),J=G[0],T=G[1],B=Object(p["useState"])(),D=Object(c["a"])(B,2),H=D[0],V=D[1],W=e=>{U&&(U.getAddress(e,((t,a)=>{"complete"===t&&"OK"===a.info?T({pos:e,address:a.regeocode.formattedAddress}):T({pos:e,address:"\u67e5\u8be2\u4f4d\u7f6e\u5931\u8d25"})})),k.setCenter(e))};Object(p["useEffect"])((()=>{W(J.pos)}),[J.pos]);var F=Object(p["useState"])(),K=Object(c["a"])(F,2),R=K[0],Z=K[1],q=()=>{U&&R&&N&&N.search(R,(function(e,t){"complete"===e&&"OK"===t.info&&t.poiList?V(t.poiList.pois):f["a"].show("\u67e5\u8be2\u5931\u8d25\uff0c\u8bf7\u786e\u8ba4\u60a8\u7684\u8f93\u5165")}))},Q=Object(p["useState"])(),X=Object(c["a"])(Q,2),Y=X[0],$=X[1],ee=(e,t)=>{if(w&&k&&2===e.length){Y&&k.remove(Y);var a=new w.Icon({size:new w.Size(40,40),image:u["mapMe"],imageSize:new w.Size(40,40)}),n=new w.Marker({position:e,icon:a});n.setLabel({direction:"bottom",offset:new w.Pixel(0,0),content:"<div class='text-blue-800 text-xs w-24 break-all whitespace-normal'>".concat(null!==t&&void 0!==t?t:"","</div>")}),k.add(n),$(n)}};Object(p["useEffect"])((()=>{i&&ee(J.pos,J.address)}),[J]);new Map([["HL_V40412072",{name:"\u6d4b\u8bd5\u4f4d\u7f6e\u8f66\u8f86",code:"HL_V40412072"}]]);var te=Object(p["useState"])([]),ae=Object(c["a"])(te,2),ne=ae[0],oe=ae[1],ce=Object(p["useState"])(JSON.parse(localStorage.getItem("OBDUserInfo")||"{}")),ie=Object(c["a"])(ce,2),se=ie[0],re=ie[1],le=function(){var e=Object(n["a"])(s.a.mark((function e(){var t;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,h({params:{LoginName:"HBLT1115",LoginPassword:"123456",LoginType:"ENTERPRISE",language:"cn"}});case 2:t=e.sent,t&&"true"===t.success&&(localStorage.setItem("OBDUserInfo",JSON.stringify({id:t.id,mds:t.mds})),re({id:t.id,mds:t.mds}),de());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),de=function(){var e=Object(n["a"])(s.a.mark((function e(){var t,a,n,o;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b({params:{method:"GetCustomTreeById",mds:se.mds,id:se.id}});case 2:return t=e.sent,a=[],t&&"true"===t.success&&t.data.forEach((e=>{a.push(b({params:{method:"getDeviceListByCustomId",mds:se.mds,mapType:"GAODE",id:e.id}}).then((e=>{if(e&&"true"===e.success)return e})))})),e.next=7,Promise.all(a);case 7:n=e.sent,n&&n.length>0&&(o=[],n.forEach((e=>{e&&"true"===e.success&&e.data[0].records.forEach((e=>{o.push({name:e[1],lnglat:[e[2],e[3]],carPlate:e[25],IEMI:e[11]})}))})),oe(o));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pe=Object(p["useState"])(),ue=Object(c["a"])(pe,2),fe=ue[0],ve=ue[1],he=function(){var e=Object(n["a"])(s.a.mark((function e(t){var a,n,o,c,i;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b({params:{method:"getHistoryMByMUtcNew",mds:se.mds,mapType:"GAODE",macid:t,playLBS:!0,from:j()().subtract(3,"day").valueOf(),to:j()().valueOf()}});case 2:if(a=e.sent,!a||"true"!==a.success){e.next=11;break}if(""!==a.data[0].Point){e.next=7;break}return f["a"].show("\u8be5\u8f66\u8f86\u8fd1\u4e09\u65e5\u65e0\u8f68\u8ff9\u4fe1\u606f"),e.abrupt("return");case 7:c=null===(n=a.data[0])||void 0===n||null===(o=n.Point)||void 0===o?void 0:o.split(";"),i=[],c.forEach((e=>{var t=e.split(",");void 0!==t[0]&&""!==t[0]&&void 0!==t[1]&&""!==t[1]&&i.push([t[0],t[1]])})),ve(i);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),me=Object(p["useState"])({}),be=Object(c["a"])(me,2),we=be[0],ge=be[1];Object(p["useEffect"])((()=>{if(w&&k){we&&k.remove(we);var e=new w.Polyline({path:null===fe||void 0===fe?void 0:fe.map((e=>new w.LngLat(Number(e[0]),Number(e[1])))),strokeWeight:12,strokeColor:"blue",lineJoin:"round"});k.setZoom(15),k.setCenter(new w.LngLat(Number(null===fe||void 0===fe?void 0:fe[0][0]),Number(null===fe||void 0===fe?void 0:fe[0][1]))),k.add(e),ge(e)}}),[fe]);var je=Object(p["useState"])(),Ae=Object(c["a"])(je,2),Me=Ae[0],Oe=Ae[1],xe=a&&Me&&Object(A["jsxs"])("div",{className:"flex items-center",_nk:"".concat(M,"11"),children:[Object(A["jsxs"])("div",{className:"flex-1",_nk:"".concat(M,"12"),children:[Object(A["jsx"])("div",{_nk:"".concat(M,"13"),children:"\u9009\u4e2d\u8f66\u8f86\u4fe1\u606f\u5982\u4e0b"}),Object(A["jsxs"])("div",{_nk:"".concat(M,"14"),children:["\u8f66\u724c\u53f7\uff1a",null===Me||void 0===Me?void 0:Me.carPlate]}),Object(A["jsxs"])("div",{_nk:"".concat(M,"15"),children:["\u8bbe\u5907\u540d\uff1a",null===Me||void 0===Me?void 0:Me.name]})]}),Object(A["jsxs"])("div",{className:"text-blue-500 cursor-pointer space-y-1",_nk:"".concat(M,"16"),children:[Object(A["jsx"])("div",{onClick:()=>{null!==Me&&void 0!==Me&&Me.carPlate?d["a"].push("/bookCar/user/home/detail/".concat(null===Me||void 0===Me?void 0:Me.carPlate)):f["a"].show("\u8f66\u8f86\u4fe1\u606f\u4e0d\u5168\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458")},_nk:"".concat(M,"17"),children:"\u67e5\u770b\u8be6\u60c5"}),Object(A["jsx"])("div",{onClick:()=>{he(Me.IEMI)},_nk:"".concat(M,"18"),children:"\u67e5\u770b\u8f68\u8ff9"})]})]}),ke=Object(p["useState"])(),ye=Object(c["a"])(ke,2),Ie=ye[0],Le=ye[1];Object(p["useEffect"])((()=>{if(w&&k){Ie&&k.remove(Ie);var e=new w.Icon({size:new w.Size(40,40),image:u["mapCar"],imageSize:new w.Size(40,41)}),t=[];ne.forEach((a=>{var n,o=new w.Marker({icon:e,position:a.lnglat});o.setLabel({direction:"bottom",offset:new w.Pixel(0,0),content:"<div class='text-blue-800 text-xs text-center w-16 break-all whitespace-normal'>\n          \u724c\u7167\uff1a".concat(null!==(n=a.carPlate)&&void 0!==n?n:"","\n        </div>")}),o.on("click",(()=>{Oe(a)})),t.push(o)}));var a=new w.OverlayGroup(t);k.add(a),k.setFitView(),Le(a)}}),[ne]),Object(p["useEffect"])((()=>{a&&(le(),console.log("OBDUserInf11o"))}),[]),Object(p["useEffect"])((()=>{de()}),[se]);var Ue=()=>{k&&k.setFitView()},Se=i&&Object(A["jsxs"])(A["Fragment"],{children:[Object(A["jsxs"])("div",{className:"my-2 relative",_nk:"".concat(M,"19"),children:[Object(A["jsx"])("input",{onChange:e=>Z(e.target.value),type:"text",className:"w-full py-1 pl-2 pr-4 text-gray-700 bg-white border border-gray-300 rounded focus:border-blue-500 focus:ring",placeholder:"\u641c\u7d22\u60a8\u9700\u8981\u7684\u5730\u70b9",_nk:"".concat(M,"21")}),Object(A["jsx"])("span",{className:"absolute inset-y-0 right-0 flex items-center p-2 m-1 bg-blue-400 rounded",onClick:()=>q(),_nk:"".concat(M,"31"),children:Object(A["jsx"])("div",{className:"text-white flex",_nk:"".concat(M,"1a"),children:Object(A["jsx"])("span",{className:"text-sm",_nk:"".concat(M,"32"),children:"\u641c\u7d22"})})})]}),H&&Object(A["jsx"])("div",{className:"bg-white mb-3 h-40 overflow-scroll",_nk:"".concat(M,"1b"),children:H.map(((e,t)=>Object(A["jsxs"])("div",{className:"m-1 p-2 shadow-sm rounded",onClick:()=>{T({address:e.address,pos:[e.location.lng,e.location.lat]})},_nk:"iAr".concat(M,"1c"),children:[Object(A["jsx"])("div",{className:"text-sm",_nk:"".concat(M,"1d"),children:e.name}),Object(A["jsxs"])("div",{className:"text-sm text-gray-500",_nk:"".concat(M,"1e"),children:["\u5730\u5740\uff1a",e.address]})]},t)))}),Object(A["jsxs"])("div",{className:"bg-white text-gray-700 mb-2 flex px-2 py-1 rounded break-all shadow",_nk:"".concat(M,"1f"),children:["\u9009\u62e9\u4f4d\u7f6e\uff1a",J.address]}),Object(A["jsx"])("div",{onClick:()=>t&&t(J.address),className:"mx-auto w-48 text-center py-1.5 font-semibold rounded-full bg-blue-400 text-white",_nk:"".concat(M,"1g"),children:"\u4f7f\u7528\u8be5\u5730\u5740"})]}),_e=a&&Object(A["jsx"])("button",{onClick:()=>Ue(),className:"mx-auto px-2 py-0.5 font-medium tracking-wide text-white capitalize transition-colors duration-200 transform bg-blue-400 rounded-md hover:bg-blue-500 focus:outline-none focus:ring focus:ring-blue-300 focus:ring-opacity-80",_nk:"".concat(M,"41"),children:"\u67e5\u770b\u6240\u6709\u8f66\u8f86"});return Object(A["jsxs"])("div",{className:"m-2 p-2 relative bg-white rounded shadow",_nk:"".concat(M,"1h"),children:[Object(A["jsx"])("div",{id:"container",className:"".concat(r||"h-96"," relative w-full rounded mb-2"),_nk:"".concat(M,"1i"),children:Object(A["jsx"])("div",{className:"absolute bottom-2 left-32 z-50",_nk:"".concat(M,"1j"),children:_e})}),xe,Se]})};t["default"]=O},hi0z:function(e,t,a){"use strict";(function(t,a){e.exports=a()})(0,(function(){function e(e){var n=[];return e.AMapUI&&n.push(t(e.AMapUI)),e.Loca&&n.push(a(e.Loca)),Promise.all(n)}function t(e){return new Promise((function(t,a){var s=[];if(e.plugins)for(var r=0;r<e.plugins.length;r+=1)-1==o.AMapUI.plugins.indexOf(e.plugins[r])&&s.push(e.plugins[r]);if(c.AMapUI===n.failed)a("\u524d\u6b21\u8bf7\u6c42 AMapUI \u5931\u8d25");else if(c.AMapUI===n.notload){c.AMapUI=n.loading,o.AMapUI.version=e.version||o.AMapUI.version,r=o.AMapUI.version;var l=document.body||document.head,d=document.createElement("script");d.type="text/javascript",d.src="https://webapi.amap.com/ui/"+r+"/main.js",d.onerror=function(e){c.AMapUI=n.failed,a("\u8bf7\u6c42 AMapUI \u5931\u8d25")},d.onload=function(){if(c.AMapUI=n.loaded,s.length)window.AMapUI.loadUI(s,(function(){for(var e=0,a=s.length;e<a;e++){var n=s[e].split("/").slice(-1)[0];window.AMapUI[n]=arguments[e]}for(t();i.AMapUI.length;)i.AMapUI.splice(0,1)[0]()}));else for(t();i.AMapUI.length;)i.AMapUI.splice(0,1)[0]()},l.appendChild(d)}else c.AMapUI===n.loaded?e.version&&e.version!==o.AMapUI.version?a("\u4e0d\u5141\u8bb8\u591a\u4e2a\u7248\u672c AMapUI \u6df7\u7528"):s.length?window.AMapUI.loadUI(s,(function(){for(var e=0,a=s.length;e<a;e++){var n=s[e].split("/").slice(-1)[0];window.AMapUI[n]=arguments[e]}t()})):t():e.version&&e.version!==o.AMapUI.version?a("\u4e0d\u5141\u8bb8\u591a\u4e2a\u7248\u672c AMapUI \u6df7\u7528"):i.AMapUI.push((function(e){e?a(e):s.length?window.AMapUI.loadUI(s,(function(){for(var e=0,a=s.length;e<a;e++){var n=s[e].split("/").slice(-1)[0];window.AMapUI[n]=arguments[e]}t()})):t()}))}))}function a(e){return new Promise((function(t,a){if(c.Loca===n.failed)a("\u524d\u6b21\u8bf7\u6c42 Loca \u5931\u8d25");else if(c.Loca===n.notload){c.Loca=n.loading,o.Loca.version=e.version||o.Loca.version;var s=o.Loca.version,r=o.AMap.version.startsWith("2"),l=s.startsWith("2");if(r&&!l||!r&&l)a("JSAPI \u4e0e Loca \u7248\u672c\u4e0d\u5bf9\u5e94\uff01\uff01");else{r=o.key,l=document.body||document.head;var d=document.createElement("script");d.type="text/javascript",d.src="https://webapi.amap.com/loca?v="+s+"&key="+r,d.onerror=function(e){c.Loca=n.failed,a("\u8bf7\u6c42 AMapUI \u5931\u8d25")},d.onload=function(){for(c.Loca=n.loaded,t();i.Loca.length;)i.Loca.splice(0,1)[0]()},l.appendChild(d)}}else c.Loca===n.loaded?e.version&&e.version!==o.Loca.version?a("\u4e0d\u5141\u8bb8\u591a\u4e2a\u7248\u672c Loca \u6df7\u7528"):t():e.version&&e.version!==o.Loca.version?a("\u4e0d\u5141\u8bb8\u591a\u4e2a\u7248\u672c Loca \u6df7\u7528"):i.Loca.push((function(e){e?a(e):a()}))}))}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var n;(function(e){e.notload="notload",e.loading="loading",e.loaded="loaded",e.failed="failed"})(n||(n={}));var o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},c={AMap:n.notload,AMapUI:n.notload,Loca:n.notload},i={AMap:[],AMapUI:[],Loca:[]},s=[],r=function(e){"function"==typeof e&&(c.AMap===n.loaded?e(window.AMap):s.push(e))};return{load:function(t){return new Promise((function(a,i){if(c.AMap==n.failed)i("");else if(c.AMap==n.notload){var l=t.key,d=t.version,p=t.plugins;l?(window.AMap&&"lbs.amap.com"!==location.host&&i("\u7981\u6b62\u591a\u79cdAPI\u52a0\u8f7d\u65b9\u5f0f\u6df7\u7528"),o.key=l,o.AMap.version=d||o.AMap.version,o.AMap.plugins=p||o.AMap.plugins,c.AMap=n.loading,d=document.body||document.head,window.___onAPILoaded=function(o){if(delete window.___onAPILoaded,o)c.AMap=n.failed,i(o);else for(c.AMap=n.loaded,e(t).then((function(){a(window.AMap)}))["catch"](i);s.length;)s.splice(0,1)[0]()},p=document.createElement("script"),p.type="text/javascript",p.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+o.AMap.version+"&key="+l+"&plugin="+o.AMap.plugins.join(","),p.onerror=function(e){c.AMap=n.failed,i(e)},d.appendChild(p)):i("\u8bf7\u586b\u5199key")}else if(c.AMap==n.loaded)if(t.key&&t.key!==o.key)i("\u591a\u4e2a\u4e0d\u4e00\u81f4\u7684 key");else if(t.version&&t.version!==o.AMap.version)i("\u4e0d\u5141\u8bb8\u591a\u4e2a\u7248\u672c JSAPI \u6df7\u7528");else{if(l=[],t.plugins)for(d=0;d<t.plugins.length;d+=1)-1==o.AMap.plugins.indexOf(t.plugins[d])&&l.push(t.plugins[d]);l.length?window.AMap.plugin(l,(function(){e(t).then((function(){a(window.AMap)}))["catch"](i)})):e(t).then((function(){a(window.AMap)}))["catch"](i)}else if(t.key&&t.key!==o.key)i("\u591a\u4e2a\u4e0d\u4e00\u81f4\u7684 key");else if(t.version&&t.version!==o.AMap.version)i("\u4e0d\u5141\u8bb8\u591a\u4e2a\u7248\u672c JSAPI \u6df7\u7528");else{var u=[];if(t.plugins)for(d=0;d<t.plugins.length;d+=1)-1==o.AMap.plugins.indexOf(t.plugins[d])&&u.push(t.plugins[d]);r((function(){u.length?window.AMap.plugin(u,(function(){e(t).then((function(){a(window.AMap)}))["catch"](i)})):e(t).then((function(){a(window.AMap)}))["catch"](i)}))}}))},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},c={AMap:n.notload,AMapUI:n.notload,Loca:n.notload},i={AMap:[],AMapUI:[],Loca:[]}}}}))}}]);