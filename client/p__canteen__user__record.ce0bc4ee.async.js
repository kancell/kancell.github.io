(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[55],{"/rzS":function(e,t,c){"use strict";c.r(t);var a=c("k1fw"),n=c("tJVT"),s=c("9og8"),r=c("WmNS"),i=c.n(r),o=c("9mPY"),l=c("q1tI"),d=c("8xVO"),x=c("uzmA"),b=c("9kvl"),u=c("PCcL"),j=c("a2t3"),m=c("pf/J"),h=c("VsxY"),p=c("nKUr"),k="tvNk",v=()=>{var e=Object(b["e"])("@@initialState"),t=e.initialState,c=Object(b["e"])("useWeChat"),r=c.wxPayAwake,v=t,O=v.user,f=Object(p["jsxs"])("div",{className:"flex items-center m-4 p-4 rounded-lg bg-white",_nk:"".concat(k,"11"),children:[Object(p["jsx"])("div",{className:"shadow-lg rounded-full h-14 w-14",_nk:"".concat(k,"12"),children:Object(p["jsx"])("img",{src:null!==O&&void 0!==O&&O.wxHeadImage?null===O||void 0===O?void 0:O.wxHeadImage:d["d"],className:"rounded-full align-middle border-none h-14 w-14",_nk:"".concat(k,"21")})}),Object(p["jsxs"])("div",{className:"pl-4",_nk:"".concat(k,"13"),children:[Object(p["jsx"])("p",{className:"text-lg font-medium",_nk:"".concat(k,"31"),children:null!==O&&void 0!==O&&O.userName?null===O||void 0===O?void 0:O.userName:"\u672a\u767b\u5f55"}),Object(p["jsx"])("p",{className:"text-sm font-medium",_nk:"".concat(k,"32"),children:null!==O&&void 0!==O&&O.deptName?null===O||void 0===O?void 0:O.deptName:""}),Object(p["jsxs"])("p",{className:"text-sm text-gray-500 flex items-center",_nk:"".concat(k,"33"),children:[Object(p["jsx"])("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 inline",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",_nk:"".concat(k,"41"),children:Object(p["jsx"])("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z",_nk:"".concat(k,"51")})}),Object(p["jsx"])("span",{_nk:"".concat(k,"61"),children:null!==O&&void 0!==O&&O.phoneNumber?null===O||void 0===O?void 0:O.phoneNumber:""})]})]})]}),w=function(){var e=Object(s["a"])(i.a.mark((function e(t){var c;return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["o"])({params:{pid:t}});case 2:c=e.sent,c&&c.status?(r(c.result),W()):m["a"].show("\u7f51\u7edc\u6216\u670d\u52a1\u5668\u5f02\u5e38");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(s["a"])(i.a.mark((function e(t){var c;return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["q"])({data:{pid:t}});case 2:c=e.sent,c&&c.status&&(m["a"].show(c.message),W());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(s["a"])(i.a.mark((function e(t){var c;return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["c"])({params:{pid:t}});case 2:c=e.sent,c&&c.status&&(m["a"].show(c.message),W());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=Object(l["useState"])(!1),y=Object(n["a"])(_,2),C=y[0],P=y[1],S=Object(l["useState"])(),z=Object(n["a"])(S,2),L=z[0],I=z[1],A=e=>{P(!0),I({pid:e})},J=C&&L&&Object(p["jsxs"])("div",{_nk:"".concat(k,"14"),children:[Object(p["jsx"])("div",{onClick:()=>P(!1),className:"fixed left-0 top-0 bg-opacity-60 bg-gray-800 w-screen h-screen z-40",_nk:"".concat(k,"15")}),Object(p["jsxs"])("div",{className:"w-4/5 px-6 pt-6 shadow rounded bg-white fixed top-1/2 transform -translate-y-1/2 left-1/2 -translate-x-1/2 z-50",_nk:"".concat(k,"16"),children:[Object(p["jsx"])("div",{className:"text-lg text-center",_nk:"".concat(k,"17"),children:"\u786e\u8ba4\u8981\u53d6\u6d88\u8ba2\u5355\u5e76\u9000\u6b3e\u5417\uff1f"}),Object(p["jsxs"])("div",{className:"mt-4",_nk:"".concat(k,"18"),children:[Object(p["jsx"])("div",{className:"flex justify-between",_nk:"".concat(k,"19"),children:Object(p["jsx"])("label",{className:"block mb-1 text-sm font-medium text-gray-600",_nk:"".concat(k,"71"),children:"\u9000\u6b3e\u539f\u56e0"})}),Object(p["jsx"])("input",{value:L.reason||"",onChange:e=>I(Object(a["a"])(Object(a["a"])({},L),{},{reason:e.target.value})),className:"block w-full px-4 py-1.5 text-gray-700 bg-white border border-gray-300 rounded",_nk:"".concat(k,"81")})]}),Object(p["jsxs"])("div",{className:"flex mt-5 text-base divide-x border-t border-gray-100 -mx-6",_nk:"".concat(k,"1a"),children:[Object(p["jsx"])("div",{onClick:()=>P(!1),className:"flex-1 text-center py-3",_nk:"".concat(k,"1b"),children:"\u53d6\u6d88"}),Object(p["jsx"])("div",{onClick:Object(s["a"])(i.a.mark((function e(){var t;return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(L.pid){e.next=2;break}return e.abrupt("return");case 2:if(L.reason){e.next=5;break}return m["a"].show("\u8bf7\u586b\u5199\u9000\u6b3e\u539f\u56e0"),e.abrupt("return");case 5:return e.prev=5,e.next=8,Object(u["s"])({data:L});case 8:t=e.sent,t&&t.status&&(m["a"].show(t.message),W(),P(!1)),e.next=14;break;case 12:e.prev=12,e.t0=e["catch"](5);case 14:case"end":return e.stop()}}),e,null,[[5,12]])}))),className:"flex-1 text-center py-3 text-blue-400",_nk:"".concat(k,"1c"),children:"\u786e\u5b9a"})]})]})]}),V=Object(l["useState"])([]),q=Object(n["a"])(V,2),G=q[0],H=q[1],W=function(){var e=Object(s["a"])(i.a.mark((function e(){var t;return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(u["m"])({data:{userId:null===O||void 0===O?void 0:O.id}});case 3:t=e.sent,t&&t.status&&H(t.result.orderList),e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),F=(e,t)=>{var c={receivingGood:!1,refundPay:!1,cancelOrder:!1,goPay:!1};switch(e){case"\u5f85\u652f\u4ed8":case"\u63d0\u4ea4\u6210\u529f":c.goPay=!0,c.cancelOrder=!0;break;case"\u4ed8\u6b3e\u6210\u529f":c.refundPay=!0;break;case"\u5df2\u5b8c\u6210":c.refundPay=!0;break;case"\u5f85\u6536\u8d27":c.receivingGood=!0;break;case"\u5f85\u53d1\u8d27":c.refundPay=!0;break;case"\u7528\u6237\u53d6\u6d88":case"\u8d85\u65f6\u81ea\u52a8\u53d6\u6d88":case"\u9000\u6b3e\u6210\u529f":case"\u9000\u6b3e\u5f02\u5e38":case"\u9000\u6b3e\u4e2d":case"\u652f\u4ed8\u72b6\u6001\u5f02\u5e38":break;default:break}return Object(p["jsxs"])(p["Fragment"],{children:[c.receivingGood&&Object(p["jsx"])("div",{onClick:()=>{h["a"].confirm({title:"\u786e\u8ba4\u8d27\u7269\u5df2\u7ecf\u6536\u5230\u4e86\u5417",onCancel:()=>{},onOk:()=>g(t)})},className:"rounded border border-red-500 text-red-500 py-1 px-2 my-2 mx-1 text-xs",_nk:"".concat(k,"1d"),children:"\u786e\u8ba4\u6536\u8d27"}),c.goPay&&Object(p["jsx"])("div",{onClick:()=>w(t),className:"rounded border border-red-500 text-red-500 py-1 px-2 my-2 mx-1 text-xs",_nk:"".concat(k,"1e"),children:"\u524d\u5f80\u652f\u4ed8"}),c.cancelOrder&&Object(p["jsx"])("div",{onClick:()=>{h["a"].confirm({title:"\u786e\u8ba4\u8981\u53d6\u6d88\u8ba2\u5355\u5417",onCancel:()=>{},onOk:()=>N(t)})},className:"rounded border border-red-500 text-red-500 py-1 px-2 my-2 mx-1 text-xs",_nk:"".concat(k,"1f"),children:"\u53d6\u6d88\u8ba2\u5355"}),c.refundPay&&Object(p["jsx"])("div",{onClick:()=>A(t),className:"rounded border border-red-500 text-red-500 py-1 px-2 my-2 mx-1 text-xs",_nk:"".concat(k,"1g"),children:"\u7533\u8bf7\u9000\u6b3e"})]})},M=G&&G.length>0?G.map(((e,t)=>Object(p["jsxs"])("div",{className:"my-2 px-3 py-2 bg-white",onClick:()=>{b["a"].push("/canteen/user/recordDetail/".concat(e.pid))},_nk:"iAr".concat(k,"1h"),children:[Object(p["jsxs"])("div",{className:"flex justify-between",_nk:"".concat(k,"1i"),children:[Object(p["jsxs"])("div",{_nk:"".concat(k,"1j"),children:[Object(p["jsx"])("div",{className:"text-lg",_nk:"".concat(k,"1k"),children:e.canteenName}),Object(p["jsxs"])("div",{className:"text-xs text-gray-400",_nk:"".concat(k,"1l"),children:["\u8ba2\u5355\u53f7\uff1a",e.pid]})]}),Object(p["jsx"])("div",{className:"text-red-600 text-sm",_nk:"".concat(k,"1m"),children:e.orderStatus})]}),Object(p["jsx"])("div",{className:"flex flex-1 overflow-x-auto pt-2 -mx-1",_nk:"".concat(k,"1n"),children:e.orderItemList.map(((e,t)=>{var c,a;return Object(p["jsxs"])("div",{className:"flex flex-col mx-1 flex-shrink-0",_nk:"iAr".concat(k,"1o"),children:[Object(p["jsx"])("div",{className:"px-0.5 shadow-xs",_nk:"".concat(k,"1p"),children:Object(p["jsx"])(x["a"],{fit:"contain",src:null===(c=e.picList)||void 0===c||null===(a=c[0])||void 0===a?void 0:a.base64,className:"h-14 w-14 mx-auto rounded",_nk:"".concat(k,"91")})}),Object(p["jsx"])("div",{className:"text-gray-500 pt-1 pl-1 text-sm",_nk:"".concat(k,"1q"),children:e.goodsName})]},e.goodsName)}))}),Object(p["jsxs"])("div",{className:"border-t border-b -mx-2 mt-2 px-2 py-0.5 text-right border-gray-100",_nk:"".concat(k,"1r"),children:[Object(p["jsx"])("span",{className:"text-sm",_nk:"".concat(k,"62"),children:"\u91d1\u989d\uff1a\uffe5"}),Object(p["jsx"])("span",{className:"text-xl",_nk:"".concat(k,"63"),children:e.totalPrice})]}),Object(p["jsx"])("div",{onClick:e=>e.stopPropagation(),className:"flex flex-row-reverse items-center -mb-2",_nk:"".concat(k,"1s"),children:F(e.orderStatus,e.pid)})]},e.pid))):Object(p["jsx"])("div",{className:"flex flex-col ml-1 items-center justify-center h-20 w-full overflow-x-auto bg-white mt-2 rounded text-gray-500 font-semibold",_nk:"".concat(k,"1t"),children:"\u6682\u65e0\u8ba2\u5355\u4fe1\u606f"});return Object(l["useEffect"])((()=>{W()}),[]),Object(p["jsxs"])(p["Fragment"],{children:[J,Object(p["jsxs"])("div",{className:"min-h-screen",_nk:"".concat(k,"1u"),children:[Object(p["jsx"])("div",{className:"sticky top-0 z-10",_nk:"".concat(k,"1v"),children:Object(p["jsx"])(o["a"],{title:"\u98df\u5802\u8ba2\u9910",className:"bg-yellow-300",_nk:"".concat(k,"a1")})}),Object(p["jsx"])("div",{className:"bg-gradient-to-b py-1 from-yellow-300 via-yellow-200 to-white rounded-b-lg",_nk:"".concat(k,"110"),children:f}),Object(p["jsx"])("div",{_nk:"".concat(k,"111"),children:M}),Object(p["jsx"])("div",{className:"h-24",_nk:"".concat(k,"112")})]}),Object(p["jsx"])(j["a"],{_nk:"".concat(k,"b1")})]})};t["default"]=v}}]);