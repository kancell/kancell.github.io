(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[28],{"A/Bm":function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return N}));var c=a("k1fw"),n=a("9og8"),r=a("tJVT"),i=a("WmNS"),s=a.n(i),l=a("q1tI"),o=a("9mPY"),u=a("5Ftn"),d=a("pf/J"),b=a("sda0"),v=a("tU6r"),j=a("B16J"),p=a("5Ipf"),m=a("BuJn"),h=a("SSz/"),x=a("Ty5D"),O=a("9kvl"),k=a("pAFO"),f=a("nKUr"),w="boTF";function N(){var e,t=Object(x["h"])(),a=t,i=Object(O["e"])("@@initialState"),N=i.initialState,g=N,_=Object(l["useState"])(),y=Object(r["a"])(_,2),S=y[0],F=y[1],C=function(){var e=Object(n["a"])(s.a.mark((function e(){var t,n,r,i,l;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(k["b"])({params:{id:a.id}});case 2:t=e.sent,t&&t.status&&(F(t.result),l=[],t.result.vehicleAssignmentFormList.forEach((e=>{l.push({applicationFormId:e.applicationFormId,driverName:e.driverName,driverMobile:e.driverMobile,vehicleInfo:e.vehicleInfo})})),Q(l),z(Object(c["a"])(Object(c["a"])({},L),{},{applicationFormId:a.id,arrivalTime:null===(n=t.result)||void 0===n?void 0:n.vehicleApplicationForm.arrivalTime,assignorName:g.user.userName,assignorMobile:g.user.phoneNumber,departureTime:null===(r=t.result)||void 0===r?void 0:r.vehicleApplicationForm.departureTime,remark:null===(i=t.result)||void 0===i?void 0:i.vehicleApplicationForm.remark})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(l["useEffect"])((()=>{C()}),[]);var T=function(){var e=Object(n["a"])(s.a.mark((function e(){var t,c,n;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(c=!0,n=[],null===(t=L.driverList)||void 0===t||t.forEach((e=>{e.vehicle&&e.driverName&&e.driverMobile?n.push(Object(k["p"])({data:{applicationId:a.id,arrivalTime:L.arrivalTime,departureTime:L.departureTime,licensePlate:e.vehicle}})):c=!1})),c){e.next=6;break}return d["a"].show("\u8bf7\u9009\u62e9\u8f66\u8f86\u4e0e\u5bf9\u5e94\u53f8\u673a"),e.abrupt("return");case 6:Promise.all(n).then((e=>{var t=e.every((e=>e&&e.status));t&&B()}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=Object(l["useState"])(!1),A=Object(r["a"])(D,2),M=A[0],E=A[1],I=Object(l["useState"])({}),J=Object(r["a"])(I,2),L=J[0],z=J[1],V=e=>{z(Object(c["a"])(Object(c["a"])({},L),{},{driverList:e}))},B=function(){var e=Object(n["a"])(s.a.mark((function e(){var t;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!M){e.next=2;break}return e.abrupt("return");case 2:return E(!0),e.prev=3,e.next=6,Object(k["g"])({data:L});case 6:t=e.sent,t&&t.status?(d["a"].show("".concat(t.message,", \u5373\u5c06\u56de\u5230\u4e0a\u4e00\u9875")),setTimeout((()=>{O["a"].replace("/bookCar/manage/divide"),E(!1)}),1e3)):E(!1),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](3),E(!1);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Object(n["a"])(s.a.mark((function e(t){var c;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!M){e.next=2;break}return e.abrupt("return");case 2:return E(!0),e.prev=3,e.next=6,Object(k["l"])({data:{description:t,id:a.id}});case 6:c=e.sent,c&&c.status?(d["a"].show("".concat(c.message,", \u5373\u5c06\u56de\u5230\u4e0a\u4e00\u9875")),setTimeout((()=>{O["a"].replace("/bookCar/manage/divide")}),3e3)):E(!1),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](3),E(!1);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}(),W="\u5ba1\u6279\u901a\u8fc7"===(null===S||void 0===S?void 0:S.vehicleApplicationForm.status)?Object(f["jsx"])(m["a"],{data:L.driverList,setData:V,departName:g.user.deptName,phoneNumber:g.user.phoneNumber,_nk:"".concat(w,"11")}):Object(f["jsx"])(f["Fragment"],{children:S&&Object(f["jsx"])(p["a"],{applyData:S,_nk:"".concat(w,"21")})}),K=Object(l["useState"])(!1),U=Object(r["a"])(K,2),q=U[0],H=U[1],Y=Object(l["useState"])(),Z=Object(r["a"])(Y,2),G=Z[0],Q=Z[1],R=function(){var e=Object(n["a"])(s.a.mark((function e(t){var c,n;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!q){e.next=2;break}return e.abrupt("return");case 2:return H(!0),e.prev=3,e.next=6,Object(k["e"])({data:t});case 6:if(c=e.sent,!c||!c.status){e.next=16;break}return d["a"].show(c.message),e.next=11,Object(k["b"])({params:{id:a.id}});case 11:n=e.sent,n&&n.status&&(F(n.result),"\u5f85\u8bc4\u4ef7"===n.result.vehicleApplicationForm.status&&(d["a"].show("\u6b64\u51fa\u884c\u5355\u5168\u90e8\u56de\u8f66\u5b8c\u6bd5\uff0c\u5373\u5c06\u8fd4\u56de\u4e0a\u4e00\u9875"),setTimeout((()=>{O["a"].replace("/bookCar/manage/divide")}),3e3))),H(!1),e.next=17;break;case 16:H(!1);case 17:e.next=22;break;case 19:e.prev=19,e.t0=e["catch"](3),H(!1);case 22:case"end":return e.stop()}}),e,null,[[3,19]])})));return function(t){return e.apply(this,arguments)}}(),X="\u51fa\u884c\u4e2d"===(null===S||void 0===S?void 0:S.vehicleApplicationForm.status)&&S.vehicleAssignmentFormList.map(((e,t)=>Object(f["jsxs"])("div",{className:"w-full",_nk:"iAr".concat(w,"31"),children:[Object(f["jsx"])(u["a"],{title:"\u51fa\u884c\u8f66\u8f86".concat(t+1),_nk:"".concat(w,"41"),children:e.vehicleInfo}),Object(f["jsx"])(u["a"],{title:"\u51fa\u884c\u53f8\u673a",_nk:"".concat(w,"42"),children:Object(f["jsxs"])("div",{className:"text-blue-500 flex items-center",_nk:"".concat(w,"32"),children:[Object(f["jsxs"])("a",{href:"tel:".concat(e.driverMobile),_nk:"".concat(w,"51"),children:[e.driverName,e.driverMobile]}),Object(f["jsx"])("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-1 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",_nk:"".concat(w,"61"),children:Object(f["jsx"])("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z",_nk:"".concat(w,"71")})})]})}),Object(f["jsx"])(u["a"],{title:"\u5f53\u524d\u72b6\u6001",_nk:"".concat(w,"43"),children:e.status}),"\u51fa\u884c\u4e2d"===e.status&&Object(f["jsx"])("button",{onClick:()=>{(null===G||void 0===G?void 0:G[t])&&R(G[t])},className:"flex text-base font-bold justify-center flex-1 text-white bg-blue-500 py-1 px-12 my-4 rounded-full mx-auto focus:outline-none hover:bg-blue-600",_nk:"".concat(w,"81"),children:q?"\u5904\u7406\u4e2d":"\u786e\u8ba4".concat(e.vehicleInfo,"\u56de\u7a0b")})]},e.pid)));return Object(f["jsxs"])(f["Fragment"],{children:[Object(f["jsx"])("div",{className:"sticky top-0 bg-white z-10",_nk:"".concat(w,"33"),children:Object(f["jsx"])(o["a"],{title:"\u6d3e\u8f66",_nk:"".concat(w,"91")})}),Object(f["jsx"])("div",{className:"m-2",_nk:"".concat(w,"34"),children:Object(f["jsxs"])("div",{className:"text-gray-400 text-base mb-1",_nk:"".concat(w,"35"),children:["\u6d41\u7a0b\u72b6\u6001\uff1a",Object(f["jsx"])("span",{className:"border border-blue-400 bg-white text-blue-400 rounded px-1",_nk:"".concat(w,"a1"),children:null===S||void 0===S?void 0:S.vehicleApplicationForm.status})]})}),S&&Object(f["jsx"])(b["a"],{applyData:S,_nk:"".concat(w,"b1")}),S&&Object(f["jsx"])(v["a"],{applyData:S,_nk:"".concat(w,"c1")}),S&&Object(f["jsx"])(j["a"],{applyData:S,_nk:"".concat(w,"d1")}),W,Object(f["jsx"])(h["a"],{loading:M,status:null!==(e=null===S||void 0===S?void 0:S.vehicleApplicationForm.status)&&void 0!==e?e:"",onDivide:T,onWithDraw:P,onEditStart:()=>{d["a"].show("\u9700\u8fdb\u5165\u6d3e\u8f66\u5386\u53f2\u8bb0\u5f55\u8be6\u60c5\u8fdb\u884c\u4fee\u6539\u3002\u6b63\u5728\u8df3\u8f6c..."),setTimeout((()=>{O["a"].push("/bookCar/manage/approveHsitory/detail/"+a.id)}),2e3)},_nk:"".concat(w,"e1")}),X&&Object(f["jsxs"])("div",{className:"m-2",_nk:"".concat(w,"36"),children:[Object(f["jsx"])("div",{className:"text-gray-400 text-base mb-1",_nk:"".concat(w,"37"),children:"\u51fa\u884c\u4fe1\u606f"}),X]})]})}},BuJn:function(e,t,a){"use strict";var c=a("k1fw"),n=a("9og8"),r=a("tJVT"),i=a("WmNS"),s=a.n(i),l=a("q1tI"),o=a("5Ftn"),u=a("pf/J"),d=a("D3E4"),b=a("pAFO"),v=a("nKUr"),j="LJFf",p=e=>{var t=e.data,a=e.setData,i=e.departName,p=e.phoneNumber,m=Object(l["useState"])(0),h=Object(r["a"])(m,2),x=h[0],O=h[1],k=Object(l["useState"])(),f=Object(r["a"])(k,2),w=f[0],N=f[1],g=Object(l["useState"])(),_=Object(r["a"])(g,2),y=_[0],S=_[1],F=function(){var e=Object(n["a"])(s.a.mark((function e(){var t,a;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(b["n"])({data:{pageNum:1,pageSize:100,admin:p}});case 3:t=e.sent,t&&t.status&&(a=[],t.result.list.forEach((e=>{var t={value:e.licensePlate,label:Object(v["jsxs"])("div",{_nk:"".concat(j,"11"),children:[e.licensePlate,"(",e.department,",",e.seatNum,"\u5ea7)-",e.status]}),info:{driverName:e.driverName,driverMobile:e.driverMobile}};a.push(t)})),O(a.length),N(a)),e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(n["a"])(s.a.mark((function e(){var t,a,c;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(b["o"])({data:{department:i,pageNum:1,pageSize:1e3}});case 3:t=e.sent,t&&t.status&&(a=[],c=[...t.result.list],c.forEach((e=>{var t={value:"".concat(e.name," ").concat(e.phoneNumber),label:"".concat(e.name,"\uff08").concat(e.department,"\uff09").concat(e.phoneNumber)};a.push(t)})),S(a)),e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();Object(l["useEffect"])((()=>{F(),C()}),[]);var T=Object(l["useState"])([null]),D=Object(r["a"])(T,2),A=D[0],M=D[1];return Object(v["jsxs"])("div",{className:"m-2",_nk:"".concat(j,"12"),children:[Object(v["jsxs"])("div",{className:"flex justify-between",_nk:"".concat(j,"13"),children:[Object(v["jsx"])("div",{className:"text-gray-400 text-base mb-1",_nk:"".concat(j,"14"),children:"\u6d3e\u8f66"}),Object(v["jsxs"])("div",{className:"flex items-center",_nk:"".concat(j,"15"),children:[Object(v["jsx"])("div",{onClick:()=>{var e=[...A];e.length>=x?u["a"].show("\u60a8\u7684\u8f66\u8f86\u5df2\u5168\u90e8\u6dfb\u52a0"):(e.push(null),M(e))},className:"bg-blue-100 rounded border border-blue-400 text-blue-400 px-1 mx-1",_nk:"".concat(j,"16"),children:"\u6dfb\u52a0\u8f66\u8f86"}),Object(v["jsx"])("div",{onClick:()=>{var e=[...A];1!==e.length?(t.pop(),a(t),e.pop(),M(e)):u["a"].show("\u81f3\u5c11\u6dfb\u52a0\u4e00\u8f86\u8f66")},className:"bg-red-100 rounded border border-red-400 text-red-400 px-1 mx-1",_nk:"".concat(j,"17"),children:"\u5220\u51cf\u8f66\u8f86"})]})]}),A.map(((e,n)=>{var r,i,s,l,b;return Object(v["jsxs"])("div",{_nk:"iAr".concat(j,"18"),children:[Object(v["jsx"])(o["a"],{title:"\u8f66\u8f86".concat(n+1,"\u9009\u62e9"),_nk:"".concat(j,"21"),children:Object(v["jsx"])(d["a"],{dataSource:w,value:t&&(null===(r=t[n])||void 0===r?void 0:r.vehicle),onOk:e=>{var c,r,i,s=[...t||[]];s[n]={driverMobile:null===(c=e[0])||void 0===c?void 0:c.info.driverMobile,driverName:null===(r=e[0])||void 0===r?void 0:r.info.driverName,vehicle:null===(i=e[0])||void 0===i?void 0:i.value},a(s)},_nk:"".concat(j,"31")})}),Object(v["jsx"])(o["a"],{title:"\u53f8\u673a".concat(n+1,"\u9009\u62e9"),_nk:"".concat(j,"22"),children:Object(v["jsx"])(d["a"],{dataSource:y,value:null!==t&&void 0!==t&&null!==(i=t[n])&&void 0!==i&&i.driverName&&null!==(s=t[n])&&void 0!==s&&s.driverMobile?"".concat(null===(l=t[n])||void 0===l?void 0:l.driverName," ").concat(null===(b=t[n])||void 0===b?void 0:b.driverMobile):void 0,onOk:e=>{var r,i;if(null===t||void 0===t||!t[n])return u["a"].show("\u8bf7\u5148\u9009\u62e9\u8f66\u8f86\uff01"),!1;var s=[...t||[]];s[n]=Object(c["a"])(Object(c["a"])({},s[n]),{},{driverName:null===(r=e[0])||void 0===r?void 0:r.value.split(" ")[0],driverMobile:null===(i=e[0])||void 0===i?void 0:i.value.split(" ")[1]}),a(s)},_nk:"".concat(j,"32")})})]},n)}))]})};t["a"]=p},"SSz/":function(e,t,a){"use strict";var c=a("k1fw"),n=a("tJVT"),r=a("5Ftn"),i=a("q1tI"),s=a("VsxY"),l=a("lsKZ"),o=a("nKUr"),u="wsHj",d=e=>{var t=e.loading,a=e.status,d=e.onDivide,b=e.onWithDraw,v=e.editTag,j=e.onEditStart,p=e.onEditEnd,m=Object(i["useState"])({all:!0,withDraw:!1,modify:!1,divide:!1}),h=Object(n["a"])(m,2),x=h[0],O=h[1],k=x.all,f=x.withDraw,w=x.modify,N=x.divide;Object(i["useEffect"])((()=>{switch(a){case"\u5ba1\u6279\u901a\u8fc7":O(Object(c["a"])(Object(c["a"])({},x),{},{all:!0,divide:!0,withDraw:!0}));break;case"\u6d3e\u8f66\u6210\u529f":O(Object(c["a"])(Object(c["a"])({},x),{},{all:!0,modify:!0,withDraw:!0}));break;case"\u5df2\u63d0\u4ea4":case"\u5ba1\u6279\u4e2d":case"\u9a73\u56de":case"\u7ba1\u7406\u5458\u64a4\u56de":case"\u51fa\u884c\u4e2d":case"\u5f85\u8bc4\u4ef7":case"\u5df2\u5b8c\u6210":O(Object(c["a"])(Object(c["a"])({},x),{},{all:!1}));break;default:O(Object(c["a"])(Object(c["a"])({},x),{},{all:!1}));break}}),[a]);var g=k?Object(o["jsxs"])("div",{className:"sticky bottom-20 mb-8 flex divide-x rounded-full divide-blue-300 text-center py-2 mx-4 my-4 text-blue-500 text-base bg-gradient-to-r from-blue-100 to-blue-200",_nk:"".concat(u,"11"),children:[f&&b&&Object(o["jsx"])("div",{onClick:()=>{s["a"].confirm({title:"\u786e\u8ba4\u9a73\u56de\u8fd9\u6761\u7533\u8bf7\u5417",onCancel:()=>{},onOk:()=>b(S)})},className:"flex-1",_nk:"".concat(u,"12"),children:t?"\u5904\u7406\u4e2d":"\u9a73\u56de\u7533\u8bf7"}),N&&d&&Object(o["jsx"])("div",{onClick:()=>{s["a"].confirm({title:"\u786e\u8ba4\u6d3e\u8f66\u5417",onCancel:()=>{},onOk:()=>d()})},className:"flex-1",_nk:"".concat(u,"13"),children:t?"\u5904\u7406\u4e2d":"\u6d3e\u8f66"}),w&&j&&Object(o["jsx"])("div",{onClick:()=>{s["a"].confirm({title:v?"\u786e\u8ba4\u53d6\u6d88\u4fee\u6539\u5417":"\u786e\u8ba4\u4fee\u6539\u5417",onCancel:()=>{},onOk:()=>j()})},className:"flex-1",_nk:"".concat(u,"14"),children:v?"\u53d6\u6d88\u4fee\u6539":"\u4fee\u6539\u7533\u8bf7"}),v&&p&&Object(o["jsx"])("div",{onClick:()=>{s["a"].confirm({title:"\u786e\u8ba4\u7ed3\u675f\u4fee\u6539\u5417",onCancel:()=>{},onOk:()=>p()})},className:"flex-1",_nk:"".concat(u,"15"),children:"\u63d0\u4ea4\u4fee\u6539"})]}):Object(o["jsx"])(o["Fragment"],{}),_=Object(i["useState"])(),y=Object(n["a"])(_,2),S=y[0],F=y[1],C=Object(o["jsxs"])("div",{className:"m-2",_nk:"".concat(u,"16"),children:[Object(o["jsx"])("div",{className:"text-gray-400 text-base mb-1",_nk:"".concat(u,"17"),children:"\u5982\u60a8\u8981\u9a73\u56de\u6b64\u6761\u7533\u8bf7\uff0c\u8bf7\u586b\u5199\u7406\u7531"}),Object(o["jsx"])(r["a"],{title:"\u9a73\u56de\u7406\u7531",_nk:"".concat(u,"21"),children:Object(o["jsx"])(l["a"],{value:S,onChange:e=>{F(e)},type:"text",placeholder:"\u8bf7\u5728\u9a73\u56de\u65f6\u586b\u5199\u7406\u7531",_nk:"".concat(u,"31")})})]});return Object(o["jsxs"])(o["Fragment"],{children:[f&&C,g]})};t["a"]=d}}]);