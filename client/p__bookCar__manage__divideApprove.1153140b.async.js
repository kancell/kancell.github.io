(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[26],{"A/Bm":function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return w}));var n=a("k1fw"),c=a("9og8"),r=a("tJVT"),i=a("WmNS"),s=a.n(i),o=a("q1tI"),l=a("9mPY"),u=a("5Ftn"),d=a("pf/J"),v=a("D3E4"),b=a("sda0"),p=a("tU6r"),j=a("B16J"),m=a("5Ipf"),h=a("Ty5D"),x=a("9kvl"),O=a("pAFO"),f=a("nKUr"),k="boTF";function w(){var e=Object(h["h"])(),t=e,a=Object(x["e"])("@@initialState"),i=a.initialState,w=i,g=Object(o["useState"])(),N=Object(r["a"])(g,2),_=N[0],y=N[1],F=function(){var e=Object(c["a"])(s.a.mark((function e(){var a,n,c;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(O["b"])({params:{id:t.id}});case 2:return a=e.sent,e.next=5,Object(O["l"])({data:{pageNum:1,pageSize:1e3,department:[null===w||void 0===w?void 0:w.user.deptName,"\u529e\u516c\u5ba4"]}});case 5:n=e.sent,a&&a.status&&n&&n.status&&(U(n.result.list,a.result),y(a.result),c=[],a.result.vehicleAssignmentFormList.forEach((e=>{c.push({applicationFormId:e.applicationFormId,driverName:e.driverName,driverMobile:e.driverMobile,vehicleInfo:e.vehicleInfo})})),ae(c));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(o["useEffect"])((()=>{G(),F()}),[]);var L=function(){var e=Object(c["a"])(s.a.mark((function e(){var t,a;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=[],null===(t=D.vehicleList)||void 0===t||t.forEach((e=>{a.push(Object(O["n"])({data:{arrivalTime:D.arrivalTime,departureTime:D.departureTime,licensePlate:e}}))})),Promise.all(a).then((e=>{var t=e.every((e=>void 0!==e));t&&J()}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=Object(o["useState"])(!1),A=Object(r["a"])(S,2),T=A[0],M=A[1],I=Object(o["useState"])({}),E=Object(r["a"])(I,2),D=E[0],z=E[1],J=function(){var e=Object(c["a"])(s.a.mark((function e(){var t;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!T){e.next=2;break}return e.abrupt("return");case 2:return M(!0),e.prev=3,e.next=6,Object(O["g"])({data:D});case 6:t=e.sent,t&&t.status?(d["a"].show("".concat(t.message,", \u5373\u5c06\u56de\u5230\u4e0a\u4e00\u9875")),setTimeout((()=>{x["a"].go(-1),M(!1)}),1e3)):M(!1),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](3),M(!1);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(){return e.apply(this,arguments)}}(),P=Object(o["useState"])(),C=Object(r["a"])(P,2),B=C[0],V=C[1],U=function(){var e=Object(c["a"])(s.a.mark((function e(a,c){var r,i,o;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=[],a.forEach((e=>{var t={value:e.licensePlate,label:Object(f["jsxs"])("div",{_nk:"".concat(k,"11"),children:[e.licensePlate,"(",e.department,",",e.seatNum,"\u5ea7)-",e.status]}),info:{driverName:e.driverName,driverMobile:e.driverMobile}};r.push(t)})),V(r),i=[c.vehicleApplicationForm.vehicleInfo],0!==(null===i||void 0===i?void 0:i.length)&&(o=[...D.driverList||[]],null===i||void 0===i||i.forEach(((e,t)=>{var a=r.find((t=>t.value===e));a&&void 0===o[t]&&(o[t]=a.info)})),z(Object(n["a"])(Object(n["a"])({},D),{},{applicationFormId:t.id,arrivalTime:null===c||void 0===c?void 0:c.vehicleApplicationForm.arrivalTime,assignorName:w.user.userName,assignorMobile:w.user.phoneNumber,departureTime:null===c||void 0===c?void 0:c.vehicleApplicationForm.departureTime,remark:null===c||void 0===c?void 0:c.vehicleApplicationForm.remark,vehicleList:i,driverList:o})));case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),W=Object(o["useState"])(),q=Object(r["a"])(W,2),K=q[0],Y=q[1],G=function(){var e=Object(c["a"])(s.a.mark((function e(){var t,a,n,c;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(O["m"])({data:{department:null===_||void 0===_?void 0:_.vehicleApplicationForm.department,pageNum:1,pageSize:1e3}});case 3:return t=e.sent,e.next=6,Object(O["m"])({data:{department:"\u529e\u516c\u5ba4",pageNum:1,pageSize:1e3}});case 6:a=e.sent,t&&t.status&&a&&a.status&&(n=[],c=t.result.list.concat(a.result.list),c.forEach((e=>{var t={value:"".concat(e.name," ").concat(e.phoneNumber),label:"".concat(e.name,"\uff08").concat(e.department,"\uff09").concat(e.phoneNumber)};n.push(t)})),Y(n)),e.next=12;break;case 10:e.prev=10,e.t0=e["catch"](0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),H=0===(null===_||void 0===_?void 0:_.vehicleAssignmentFormList.length)?Object(f["jsxs"])("div",{className:"m-2",_nk:"".concat(k,"12"),children:[Object(f["jsx"])("div",{className:"text-gray-400 text-base mb-1",_nk:"".concat(k,"13"),children:"\u6d3e\u8f66"}),Object(f["jsx"])(u["a"],{title:"\u8f66\u8f86\u9009\u62e9",_nk:"".concat(k,"21"),children:Object(f["jsx"])(v["a"],{dataSource:B,value:D.vehicleList&&D.vehicleList[0],onOk:e=>{var t=[];t=[e[0].info],z(Object(n["a"])(Object(n["a"])({},D),{},{driverList:t,vehicleList:[e[0].value]}))},_nk:"".concat(k,"31")})}),Object(f["jsx"])(u["a"],{title:"\u53f8\u673a\u9009\u62e9",_nk:"".concat(k,"22"),children:Object(f["jsx"])(v["a"],{dataSource:K,value:(null===D||void 0===D?void 0:D.driverList)&&"".concat(null===D||void 0===D?void 0:D.driverList[0].driverName," ").concat(null===D||void 0===D?void 0:D.driverList[0].driverMobile),onOk:e=>{z(Object(n["a"])(Object(n["a"])({},D),{},{driverList:[{driverName:e[0].value.split(" ")[0],driverMobile:e[0].value.split(" ")[1]}]}))},_nk:"".concat(k,"32")})}),Object(f["jsx"])("button",{onClick:()=>L(),className:"flex text-base font-bold mt-2 justify-center flex-1 text-white bg-blue-500 py-1 px-8 mx-auto focus:outline-none hover:bg-indigo-600 rounded",_nk:"".concat(k,"41"),children:T?"\u5904\u7406\u4e2d":"\u6d3e\u8f66"})]}):Object(f["jsx"])(f["Fragment"],{children:_&&Object(f["jsx"])(m["a"],{applyData:_,_nk:"".concat(k,"51")})}),Q=Object(o["useState"])(!1),R=Object(r["a"])(Q,2),X=R[0],Z=R[1],$=Object(o["useState"])(),ee=Object(r["a"])($,2),te=ee[0],ae=ee[1],ne=function(){var e=Object(c["a"])(s.a.mark((function e(){var t;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!X){e.next=2;break}return e.abrupt("return");case 2:return Z(!0),e.prev=3,e.next=6,Object(O["e"])({data:te});case 6:t=e.sent,t&&t.status?(d["a"].show("".concat(t.message," , \u5373\u5c06\u56de\u5230\u4e0a\u4e00\u9875")),setTimeout((()=>{Z(!1),x["a"].go(-1)}),1e3)):Z(!1),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](3),Z(!1);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(){return e.apply(this,arguments)}}(),ce="\u51fa\u884c\u4e2d"===(null===_||void 0===_?void 0:_.vehicleApplicationForm.status)&&_.vehicleAssignmentFormList.map((e=>Object(f["jsxs"])("div",{className:"w-full",_nk:"iAr".concat(k,"14"),children:[Object(f["jsx"])(u["a"],{title:"\u51fa\u884c\u8f66\u8f86",_nk:"".concat(k,"23"),children:e.vehicleInfo}),Object(f["jsx"])(u["a"],{title:"\u51fa\u884c\u53f8\u673a",_nk:"".concat(k,"24"),children:Object(f["jsxs"])("div",{className:"text-blue-500 flex items-center",_nk:"".concat(k,"15"),children:[Object(f["jsxs"])("a",{href:"tel:".concat(e.driverMobile),_nk:"".concat(k,"61"),children:[e.driverName,e.driverMobile]}),Object(f["jsx"])("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-1 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",_nk:"".concat(k,"71"),children:Object(f["jsx"])("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z",_nk:"".concat(k,"81")})})]})}),Object(f["jsx"])(u["a"],{title:"\u5f53\u524d\u72b6\u6001",_nk:"".concat(k,"25"),children:e.status}),Object(f["jsx"])("button",{onClick:ne,className:"flex text-base font-bold mt-2 justify-center flex-1 text-white bg-blue-500 py-1 px-8 mx-24 mx-auto focus:outline-none hover:bg-indigo-600 rounded",_nk:"".concat(k,"42"),children:X?"\u5904\u7406\u4e2d":"\u786e\u8ba4\u56de\u7a0b"})]},e.pid)));return Object(f["jsxs"])(f["Fragment"],{children:[Object(f["jsx"])("div",{className:"sticky top-0 bg-white z-10",_nk:"".concat(k,"16"),children:Object(f["jsx"])(l["a"],{title:"\u6d3e\u8f66",_nk:"".concat(k,"91")})}),Object(f["jsx"])("div",{className:"m-2",_nk:"".concat(k,"17"),children:Object(f["jsxs"])("div",{className:"text-gray-400 text-base mb-1",_nk:"".concat(k,"18"),children:["\u6d41\u7a0b\u72b6\u6001\uff1a",Object(f["jsx"])("span",{className:"border border-blue-400 bg-white text-blue-400 rounded px-1",_nk:"".concat(k,"a1"),children:null===_||void 0===_?void 0:_.vehicleApplicationForm.status})]})}),_&&Object(f["jsx"])(b["a"],{applyData:_,_nk:"".concat(k,"b1")}),_&&Object(f["jsx"])(p["a"],{applyData:_,_nk:"".concat(k,"c1")}),_&&Object(f["jsx"])(j["a"],{applyData:_,_nk:"".concat(k,"d1")}),H,ce&&Object(f["jsxs"])("div",{className:"m-2",_nk:"".concat(k,"19"),children:[Object(f["jsx"])("div",{className:"text-gray-400 text-base mb-1",_nk:"".concat(k,"1a"),children:"\u51fa\u884c\u4fe1\u606f"}),ce]})]})}}}]);