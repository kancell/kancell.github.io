(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[74],{"+7SR":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return $}));var a=n("9og8"),c=n("tJVT"),o=n("WmNS"),r=n.n(o),i=n("q1tI"),s=n.n(i),l=n("9mPY"),u=n("9kvl"),d=n("Wgwc"),m=n.n(d),v=n("uzmA"),h=n("NPPy"),p=n("LQih"),f=n("YEjf"),g=n("lwsE"),b=n.n(g),x=n("W8MJ"),j=n.n(x),k=n("7W2i"),O=n.n(k),y=n("a1gu"),w=n.n(y),_=n("Nsbk"),N=n.n(_),M=n("J0tc"),T=n("p9jf"),S=n("kuXg");function Y(e){var t=C();return function(){var n,a=N()(e);if(t){var c=N()(this).constructor;n=Reflect.construct(a,arguments,c)}else n=a.apply(this,arguments);return w()(this,n)}}function C(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function E(e,t){return t?Math.sqrt(Math.pow(t.clientX-e.clientX,2)+Math.pow(t.clientY-e.clientY,2)):0}function I(e,t,n){return Math.min(Math.max(e,t),n)}var X=function(e){O()(n,e);var t=Y(n);function n(e){var a;return b()(this,n),a=t.call(this,e),a._container=void 0,a.startTouchX=0,a.startTouchY=0,a.moveX=0,a.moveY=0,a.startMoveX=0,a.startMoveY=0,a.deltaX=0,a.deltaY=0,a.moving=!1,a.zooming=!1,a.scale=1,a.startScale=void 0,a.prevDistance=0,a.originHeight=void 0,a.originWidth=void 0,a.getMaxMoveX=function(){return a.originWidth?Math.max(0,(a.scale*a.originWidth-window.innerWidth)/2):0},a.touchstart=function(e){var t=e.touches;a.startTouchX=t[0].clientX,a.startTouchY=t[0].clientY,a.startMoveX=a.moveX,a.startMoveY=a.moveY,a.moving=1===t.length&&1!==a.scale,a.zooming=2===t.length,a.zooming&&(a.startScale=a.scale,a.prevDistance=E(t[0],t[1]))},a.updateTransform=function(e,t,n){var c=e>1?t:0,o=e>1?n:0;a._container.current.style.setProperty("--x","".concat(c,"px")),a._container.current.style.setProperty("--y","".concat(o,"px")),a._container.current.style.setProperty("--scale",e)},a.touchmove=function(e){var t=e.touches;if(a.deltaX=t[0].clientX-a.startTouchX,a.deltaY=t[0].clientY-a.startTouchY,a.moving){var n=a.deltaX+a.startMoveX,c=a.deltaY+a.startMoveY,o=a.getMaxMoveX(),r=a.getMaxMoveY();a.moveX=I(n,-o,o),a.moveY=I(c,-r,r)}var i=a.props,s=i.minScale,l=i.maxScale,u=i.onChange;if(a.zooming&&2===t.length){var d=E(t[0],t[1]),m=a.startScale*d/a.prevDistance;a.scale=I(s,m,l)}a.updateTransform(a.scale,a.moveX,a.moveY),"function"===typeof u&&u({scale:a.scale,x:a.moveX,y:a.moveY}),(a.moving||a.zooming)&&(e.preventDefault(),e.stopPropagation())},a.touchEnd=function(e){var t=!1;(a.moving||a.zooming)&&(t=!0,a.moving&&a.startMoveX===a.moveX&&a.startMoveY===a.moveY&&(t=!1),e.touches.length||(a.zooming&&(a.moveX=I(a.moveX,-a.getMaxMoveX(),a.getMaxMoveX()),a.moveY=I(a.moveY,-a.getMaxMoveY(),a.getMaxMoveY()),a.zooming=!1,a.updateTransform(a.scale,a.moveX,a.moveY)),a.moving=!1,a.startTouchX=0,a.startTouchY=0,a.startScale=1)),t&&(e.preventDefault(),e.stopPropagation())},a.onload=function(e){var t=window.innerWidth,n=window.innerHeight,c=e.target,o=c.naturalWidth,r=c.naturalHeight,i=n/t,s=r/o,l=s>i;l?(a.originWidth=n/s,a.originHeight=n):(a.originWidth=t,a.originHeight=t*s)},a._container=s.a.createRef(),a}return j()(n,[{key:"componentDidMount",value:function(){S["a"].on(this._container.current,"touchstart",this.touchstart),S["a"].on(document.documentElement,"touchmove",this.touchmove),S["a"].on(document.documentElement,"touchend",this.touchEnd),S["a"].on(document.documentElement,"touchcancel",this.touchEnd)}},{key:"componentWillUnmount",value:function(){S["a"].off(this._container.current,"touchstart",this.touchstart),S["a"].off(document.documentElement,"touchmove",this.touchmove),S["a"].off(document.documentElement,"touchend",this.touchEnd),S["a"].off(document.documentElement,"touchcancel",this.touchEnd)}},{key:"getMaxMoveY",value:function(){return this.originHeight?Math.max(0,(this.scale*this.originHeight-window.innerHeight)/2):0}},{key:"render",value:function(){var e=this,t=this.props,n=t.children,a=t.className,c=t.prefixCls,o=s.a.Children.map(n,(function(t,n){return s.a.cloneElement(t,{key:+n,onLoad:e.onload})}));return s.a.createElement("div",{ref:this._container,className:"".concat(a," ").concat(c)},o)}}]),n}(i["Component"]);X.defaultProps={prefixCls:"za-pinch-zoom",minScale:1,maxScale:3};var W,P=n("cv5m");(function(e){e["before"]="loadBefore",e["start"]="loadStart",e["end"]="loadEnd",e["after"]="loadAfter"})(W||(W={}));var D=W,z=n("pnYb");function H(e){return Object(z["d"])(e)}function R(e){return Object(z["c"])(e)}var U=function(e){var t=[];return(e||[]).forEach((function(e){H(e)?t.push({url:e}):R(e)&&t.push({url:e.url,originUrl:e.originUrl,loaded:D.before})})),t},A=U,B=function(e,t){return!!(e&&"number"===typeof t&&e[t]&&e[t].originUrl)},J=B;function V(e){var t=q();return function(){var n,a=N()(e);if(t){var c=N()(this).constructor;n=Reflect.construct(a,arguments,c)}else n=a.apply(this,arguments);return w()(this,n)}}function q(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var F=function(e){var t=e.visible,n=e.images;return{visible:t,images:A(n)}},L=function(e){O()(n,e);var t=V(n);function n(){var e;b()(this,n);for(var a=arguments.length,c=new Array(a),o=0;o<a;o++)c[o]=arguments[o];return e=t.call.apply(t,[this].concat(c)),e.doubleClickTimer=void 0,e.touchStartTime=void 0,e.moving=void 0,e.state=F(e.props),e.onChange=function(t){var n=e.props.onChange;e.setState({currentIndex:t},(function(){"function"===typeof n&&n(t)}))},e.close=function(){if(e.moving)return!1;var t=e.props.onClose;"function"===typeof t&&t()},e.loadOrigin=function(){var t=e.state,n=t.currentIndex,a=void 0===n?0:n,c=t.images,o=c[a],r=o.originUrl,i=o.loaded;if(i===D.before&&r){c[a].loaded=D.start,e.setState({images:c});var s=new Image;s.onload=function(){c[a].loaded=D.end,c[a].url=r,e.setState({images:c}),setTimeout((function(){c[a].loaded=D.after,e.setState({images:c})}),1500)},s.src=r}},e.onWrapperTouchStart=function(){e.touchStartTime=Date.now()},e.onWrapperTouchEnd=function(){var t=Date.now()-e.touchStartTime,n=e.props.onClose;t<300&&(e.doubleClickTimer||e.moving?(e.doubleClickTimer&&clearTimeout(e.doubleClickTimer),e.doubleClickTimer=null):e.doubleClickTimer=setTimeout((function(){e.doubleClickTimer=null,"function"===typeof n&&n()}),300)),e.moving=!1},e.onWrapperTouchMove=function(){e.touchStartTime&&(e.moving=!0)},e.onWrapperMouseDown=function(){e.touchStartTime=Date.now()},e.onWrapperMouseUp=function(){setTimeout((function(){e.moving=!1}),0),e.touchStartTime=0},e.renderImages=function(){var t=e.props,n=t.prefixCls,a=t.minScale,c=t.maxScale,o=e.state.images;return o.map((function(e,t){return s.a.createElement("div",{className:"".concat(n,"__item"),key:+t},s.a.createElement(X,{className:"".concat(n,"__item__img"),minScale:a,maxScale:c},s.a.createElement("img",{src:e.url,alt:"",draggable:!1})))}))},e}return j()(n,[{key:"renderPagination",value:function(){var e=this.props,t=e.prefixCls,n=e.showPagination,a=this.state,c=a.currentIndex,o=void 0===c?0:c,r=a.visible,i=a.images;return r&&n&&i&&i.length>1?s.a.createElement("div",{className:"".concat(t,"__index")},o+1," / ",i.length):null}},{key:"renderOriginButton",value:function(){var e=this.state,t=e.images,n=e.currentIndex,a=void 0===n?0:n;if(0!==t.length){var c=this.props,o=c.prefixCls,r=c.locale,i=c.activeIndex,l=t[a].loaded;return l&&J(t,i)&&l!==D.after?s.a.createElement("button",{className:"".concat(o,"__origin__button"),onClick:this.loadOrigin},l===D.start&&s.a.createElement(P["a"],{className:"".concat(o,"__loading"),type:"spinner"}),r&&r[l]):null}}},{key:"render",value:function(){var e=this.props.prefixCls,t=this.state,n=t.currentIndex,a=void 0===n?0:n,c=t.visible,o=t.images;return s.a.createElement(M["a"],{direction:"center",visible:c,className:e},s.a.createElement("div",{className:"".concat(e,"__content"),onTouchStart:this.onWrapperTouchStart,onTouchEnd:this.onWrapperTouchEnd,onTouchCancel:this.onWrapperTouchEnd,onTouchMove:this.onWrapperTouchMove,onMouseDown:this.onWrapperMouseDown,onMouseMove:this.onWrapperTouchMove,onMouseUp:this.onWrapperMouseUp,onClick:this.close},c&&(null!==o&&void 0!==o&&o.length?s.a.createElement(T["a"],{showPagination:!1,onChange:this.onChange,activeIndex:a},this.renderImages()):s.a.createElement(P["a"],{className:"".concat(e,"__loading"),type:"spinner",size:"lg"}))),s.a.createElement("div",{className:"".concat(e,"__footer")},this.renderOriginButton(),this.renderPagination()))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return"visible"in e&&e.visible!==t.prevVisible||"activeIndex"in e&&e.activeIndex!==t.prevActiveIndex||"images"in e&&e.images!==t.prevImages?{visible:e.visible,activeIndex:e.activeIndex,currentIndex:e.activeIndex,images:A(e.images),prevVisible:e.visible,prevActiveIndex:e.activeIndex,prevImages:e.images}:null}}]),n}(i["Component"]);L.defaultProps={prefixCls:"za-image-preview",activeIndex:0,showPagination:!0,visible:!1};var K=Object(f["a"])("ImagePreview")(L),G=n("VsxY"),Q=n("nKUr"),Z="jUmT";function $(){var e=Object(i["useState"])(!1),t=Object(c["a"])(e,2),n=t[0],o=t[1],s=Object(i["useState"])(0),d=Object(c["a"])(s,2),f=d[0],g=d[1],b=()=>o(!1),x=e=>{o(!0),g(e)},j=Object(u["e"])("@@initialState"),k=j.initialState,O=(j.loading,j.error,j.refresh,j.setInitialState,k),y=Object(u["d"])(),w=h,_=sessionStorage.getItem("topicid"),N=Object(i["useState"])(),M=Object(c["a"])(N,2),T=M[0],S=M[1],Y=Object(i["useState"])(),C=Object(c["a"])(Y,2),E=C[0],I=C[1],X=Object(i["useState"])(),W=Object(c["a"])(X,2),P=W[0],D=W[1],z=Object(i["useState"])(),H=Object(c["a"])(z,2),R=H[0],U=H[1],A=function(){var e=Object(a["a"])(r.a.mark((function e(){var t,n;return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(p["D"])({data:{topicid:_,regid:O.user.id}});case 3:t=e.sent,void 0!=t&&(n=t.result,console.log(n+" result result"),I(n)),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=Object(a["a"])(r.a.mark((function e(){var t,n;return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(p["I"])({data:{topicid:_,regid:O.user.id}});case 2:t=e.sent,void 0!=t&&(n=t.result,S(n));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=Object(a["a"])(r.a.mark((function e(){var t,n,a;return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(p["w"])({data:{id:_,module:10}});case 2:t=e.sent,void 0!=t&&(n=t.result,D(n),a=[],n.forEach((e=>{a.push(e.base64)})),U(a));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(i["useEffect"])((()=>{A(),J(),B()}),[]);var V=function(){var e=Object(a["a"])(r.a.mark((function e(t,n,a){return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!=a){e.next=6;break}return e.next=3,Object(p["L"])({data:{regid:O.user.id,topicid:_,replyid:0,count:n+1}});case 3:e.sent,e.next=9;break;case 6:return e.next=8,Object(p["M"])({data:{regid:O.user.id,topicid:_,replyid:0,count:n-1}});case 8:e.sent;case 9:A();case 10:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),q=Object(i["useState"])(""),F=Object(c["a"])(q,2),L=F[0],$=F[1],ee=function(){var e=Object(a["a"])(r.a.mark((function e(){return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0==L.length){e.next=16;break}return e.prev=1,e.next=4,Object(p["G"])({data:{regid:O.user.id,topicid:_,replycontent:L,Uname:O.user.userName,img:O.user.wxHeadImage}});case 4:return e.sent,e.next=7,Object(p["N"])({data:{id:_,replycount:(null===E||void 0===E?void 0:E.replynum)+1}});case 7:e.sent,$(""),B(),A(),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](1),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(){return e.apply(this,arguments)}}(),te=function(){var e=Object(a["a"])(r.a.mark((function e(t){return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(p["H"])({data:{replyid:t,topicid:_}});case 2:e.sent,B(),A();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(Q["jsxs"])("div",{className:"min-h-screen bg-white",_nk:"".concat(Z,"11"),children:[Object(Q["jsx"])(Q["Fragment"],{children:R&&Object(Q["jsx"])(K,{visible:n,images:R,onClose:b,activeIndex:f,_nk:"".concat(Z,"21")})}),Object(Q["jsx"])(l["a"],{className:"sticky top-0 z-10",title:"\u8bdd\u9898\u5185\u5bb9",_nk:"".concat(Z,"31")}),Object(Q["jsxs"])("div",{className:"bg-white min-h-screen max-w-full p-4",_nk:"".concat(Z,"12"),children:[Object(Q["jsxs"])("div",{className:"w-full flex",_nk:"".concat(Z,"13"),children:[Object(Q["jsx"])("div",{className:"mx-2 w-8 h-8",_nk:"".concat(Z,"14"),children:Object(Q["jsx"])("img",{className:"rounded-full h-8 w-8",src:null===E||void 0===E?void 0:E.img,alt:"\u5934\u50cf",_nk:"".concat(Z,"41")})}),Object(Q["jsx"])("div",{className:"w-4/5 pl-2",_nk:"".concat(Z,"15"),children:Object(Q["jsx"])("div",{className:"flex justify-between",_nk:"".concat(Z,"16"),children:Object(Q["jsxs"])("div",{_nk:"".concat(Z,"17"),children:[Object(Q["jsx"])("div",{className:"text-gray-400 text-sm",_nk:"".concat(Z,"18"),children:null===E||void 0===E?void 0:E.name}),Object(Q["jsx"])("div",{className:"text-gray-400 text-sm",_nk:"".concat(Z,"19"),children:null===E||void 0===E?void 0:E.department})]})})})]}),Object(Q["jsx"])("div",{_nk:"".concat(Z,"1a"),children:Object(Q["jsx"])("p",{className:"text-gray-700 font-normal text-base mt-2 ml-3 mr-2",_nk:"".concat(Z,"51"),children:null===E||void 0===E?void 0:E.title})}),Object(Q["jsx"])("div",{className:"grid grid-cols-3 gap-2 px-4",_nk:"".concat(Z,"1b"),children:null===P||void 0===P?void 0:P.map(((e,t)=>Object(Q["jsx"])("div",{onClick:()=>x(t),_nk:"".concat(Z,"1c"),children:Object(Q["jsx"])(v["a"],{type:"bg",preview:!1,className:"h-24 w-full mx-auto",src:e.base64,alt:"",_nk:"".concat(Z,"61")})},t)))}),Object(Q["jsxs"])("div",{className:"mt-2 ml-3",_nk:"".concat(Z,"1d"),children:[Object(Q["jsx"])("p",{className:"text-gray-700 font-normal text-base mt-2 mr-2",_nk:"".concat(Z,"52"),children:null===E||void 0===E?void 0:E.topiccontent}),Object(Q["jsx"])("p",{className:"text-xs font-normal mt-2 text-gray-400",_nk:"".concat(Z,"53"),children:m()(null===E||void 0===E?void 0:E.createdTime).format("YYYY-MM-DD HH:mm:ss")})]}),Object(Q["jsxs"])("div",{className:"flex  mr-4 mt-2",_nk:"".concat(Z,"1e"),children:[Object(Q["jsx"])("img",{alt:"\u8bdd\u9898\u5ea6",className:"h-5 w-5 mt-2 ml-8 flex",src:w["hot"],_nk:"".concat(Z,"42")}),Object(Q["jsx"])("p",{className:"text-lg font-normal  ml-2",_nk:"".concat(Z,"54"),children:null===E||void 0===E?void 0:E.replynum}),Object(Q["jsx"])("img",{className:"rounded-full ml-20 w-8 h-8 ",src:null!==E&&void 0!==E&&E.isup?w["thumbsdown"]:w["thumbs"],alt:"\u70b9\u8d5e",onClick:()=>V(null===E||void 0===E?void 0:E.pid,null===E||void 0===E?void 0:E.hotnum,null===E||void 0===E?void 0:E.isup),_nk:"".concat(Z,"43")}),Object(Q["jsx"])("p",{className:"text-lg font-normal ml-1 mb-2",_nk:"".concat(Z,"55"),children:null===E||void 0===E?void 0:E.hotnum})]}),Object(Q["jsx"])("div",{className:"mt-4",_nk:"".concat(Z,"1f"),children:Object(Q["jsx"])("div",{className:"space-y-4 flex-col bg-white",_nk:"".concat(Z,"1g"),children:null===T||void 0===T?void 0:T.map(((e,t)=>Object(Q["jsxs"])("div",{className:"bg-gray-100 flex ml-5 rounded-md shadow",_nk:"".concat(Z,"1h"),children:[Object(Q["jsx"])("div",{className:"flex-shrink-0 ml-3",_nk:"".concat(Z,"1i"),children:Object(Q["jsx"])("img",{className:"mt-2 rounded-full w-10 h-10",src:e.img,alt:"\u5934\u50cf",_nk:"".concat(Z,"44")})}),Object(Q["jsxs"])("div",{className:"w-full rounded-md pl-4 pt-2 pb-1 pr-1 leading-relaxed",_nk:"".concat(Z,"1j"),children:[Object(Q["jsxs"])("div",{className:"flex justify-between",_nk:"".concat(Z,"1k"),children:[Object(Q["jsx"])("strong",{className:"text-base",_nk:"".concat(Z,"71"),children:e.name}),Object(Q["jsx"])("span",{className:"text-sm text-gray-400",_nk:"".concat(Z,"81"),children:m()(e.createdTime).format("YYYY-MM-DD HH:mm:ss")})]}),Object(Q["jsxs"])("div",{_nk:"".concat(Z,"1l"),children:[Object(Q["jsx"])("p",{className:"text-base text-gray-500",_nk:"".concat(Z,"56"),children:e.replycontent}),Object(Q["jsx"])("div",{className:" flex justify-end items-center",_nk:"".concat(Z,"1m"),children:Object(Q["jsx"])("button",{className:y.topicAdmin?"bg-blue-300  text-white text-base font-semibold rounded-full shadow hover:bg-indigo-600 px-2 py-1":"hidden",type:"submit",onClick:()=>{G["a"].confirm({title:"\u786e\u8ba4\u5220\u9664",onCancel:()=>{},onOk:()=>te(e.pid)})},_nk:"".concat(Z,"91"),children:"\u5220\u9664"})})]})]})]},e.pid)))})}),Object(Q["jsxs"])("div",{className:"w-full flex justify-center items-center bg-white sticky bottom-2 my-4",_nk:"".concat(Z,"1n"),children:[Object(Q["jsx"])("input",{className:"w-3/4 rounded-l-full shadow px-4 py-2 focus:outline-none border",type:"text",placeholder:"\u8bf4\u70b9\u4ec0\u4e48\u5427\uff01",value:L,onChange:e=>$(e.target.value),_nk:"".concat(Z,"a1")}),Object(Q["jsx"])("button",{className:"w-1/4 bg-blue-600 text-white text-base font-semibold rounded-r-full shadow hover:bg-indigo-600 py-2",onClick:()=>ee(),_nk:"".concat(Z,"92"),children:"\u8bc4\u8bba"})]})]})]})}},uzmA:function(e,t,n){"use strict";var a=n("tJVT"),c=n("q1tI"),o=n("i8i4"),r=n.n(o),i=n("nKUr"),s="x4MR";function l(e){var t=e.src,n=e.className,o=(e.alt,e.type),l=void 0===e.preview,u=Object(c["useState"])(!1),d=Object(a["a"])(u,2),m=d[0],v=d[1];return Object(c["useEffect"])((()=>{var e=document.createElement("div");m&&(r.a.render(Object(i["jsx"])("div",{onClick:()=>{v(!m),document.body.removeChild(e)},className:"".concat(m?"":"hidden"," z-50 top-0 left-0 fixed w-screen h-screen flex items-center justify-center bg-opacity-60 bg-gray-800"),_nk:"".concat(s,"11"),children:Object(i["jsx"])("img",{src:t,className:"w-auto h-auto",_nk:"".concat(s,"21")})}),e),document.body.appendChild(e))}),[m]),Object(i["jsxs"])(i["Fragment"],{children:["bg"===o&&Object(i["jsx"])("div",{className:"".concat(n||""," bg-cover bg-center cursor-pointer border"),style:{backgroundImage:"url(".concat(t,")")},onClick:()=>l&&v(!0),_nk:"".concat(s,"12")}),(!o||"img"===o)&&Object(i["jsx"])("img",{src:t,className:"".concat(n||""," cursor-pointer border"),onClick:()=>l&&v(!0),_nk:"".concat(s,"22")})]})}t["a"]=Object(c["memo"])(l)}}]);